<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BJG - Standings</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/bj.css">
</head>

<body>
    <div id="nav-placeholder"></div>

    <div class="spinner-border" role="status" id="loading">
        <span class="sr-only"></span>
      </div>
    
    <div class="container">
        <div class="title-container">
            <h3><span id="year"></span> Standings</h3>
        </div>
        <script>
            document.getElementById("year").innerHTML = new Date().getFullYear();
          </script>
        
        <div id="fedexContainer" style="display: none;">  
            <table id="fxpointstable" class="standings-table"></table>
        </div>
        
        <div>
            <table id="bjpointstable"></table>
        </div>
        
        <div>
            <table id="spointstable"></table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../static/include-nav.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1066.0.min.js"></script>
    
    <!-- Page-specific scripts -->
    <script type="module" src="../static/standingsbj.js"></script>
    <script type="module" src="../static/standingss.js"></script>
    <script type="module" src="../static/standingsfx.js"></script> 
    <script type="module" src="/static/commonscripts.js"></script>


 
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Set the year
            const currentYear = new Date().getFullYear();
            document.getElementById("year").innerHTML = currentYear;
            
            // Fetch FedEx start date from DynamoDB
            (async function fetchDates() {
                try {
                    const response = await fetch('https://yo6lbyfxd1.execute-api.us-east-1.amazonaws.com/prod/dates', {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    console.log("json response :", data);
                    
                    // Find the FedEx date in the array
                    const fedExDate = data.dates.find(item => item.datename === 'FedEx');
                    if (fedExDate) {
                        const fedExStartDate = new Date(fedExDate.date);
                        const today = new Date();
                        console.log('Today:', today);
                        console.log('FedEx start date:', fedExStartDate);
                        
                        // Show fedexContainer if after the start date
                        if (today >= fedExStartDate) {
                            document.getElementById('fedexContainer').style.display = 'block';
                        }
                    }
                    
                } catch (error) {
                    console.error('Error fetching FedEx start date:', error);
                    // Fallback to default behavior if fetch fails
                    const defaultShowDate = new Date('2025-09-15');
                    const today = new Date();
                    if (today >= defaultShowDate) {
                        document.getElementById('fedexContainer').style.display = 'block';
                    }
                }
            })();
        });

    </script>

</body>
</html>
